#cloud-config
hostname: ${hostname}
fqdn: ${fqdn}
manage_etc_hosts: true
timezone: UTC

users:
  - name: root
    lock_passwd: false
    ssh_authorized_keys:
      - ${ssh_key}
  - name: ${vm_user}
    groups: wheel
    sudo: ALL=(ALL) NOPASSWD:ALL
    shell: /bin/bash
    lock_passwd: false
    passwd: <YOUR-PASSWORD-HASH-HERE>
    ssh_authorized_keys:
      - ${ssh_key}

# Enable password authentication for console access, SSH keys preferred
ssh_pwauth: true

# Update packages on first boot
package_update: true
package_upgrade: true

# Install basic packages
packages:
  - curl
  - wget
  - vim
  - git
  - htop
  - net-tools
# - chrony

# Run commands on first boot
runcmd:
  - echo "VM provisioned successfully by Terraform" > /etc/motd
  - systemctl enable --now sshd
  - systemctl status sshd

# Configure NTP (chrony will be installed from packages list)
# ntp:
#  enabled: true

# Final message
final_message: "The system is finally up, after $UPTIME seconds"
